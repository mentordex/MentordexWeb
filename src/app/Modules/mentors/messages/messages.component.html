<section class="pt-125 py-65 bg-md-f8f8f8">
    <div class="container">
        <div class="row">
            <div class="col-lg-11 mx-auto">
                <div class="profile-steps-rightsidebar-column bg-white">
                    <div class="row">
                        <ng-container *ngIf="noJobsFound; else jobsFound;">
                            <div class="col-md-4 pr-md-0">
                                <div class="chatbox--searcharea">
                                    <div class="position-relative w-100">
                                        <button class="search--btn" type="submit">
                                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                            <path d="M7.875 14.625C11.6029 14.625 14.625 11.6029 14.625 7.875C14.625 4.14708 11.6029 1.125 7.875 1.125C4.14708 1.125 1.125 4.14708 1.125 7.875C1.125 11.6029 4.14708 14.625 7.875 14.625Z" stroke="#3BB3BD" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                            <path d="M12.9375 12.9375L16.875 16.875" stroke="#3BB3BD" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                            </svg>
                                        </button>
                                        <input type="search" class="navbar-serach-input w-100 pl-5" placeholder="Search Mentors">
                                    </div>
                                </div>
                                <div class="chatbox-inboxlist">
                                    <ul>

                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-8 border-md-chatarea pl-md-0">
                                <div class="nochat-area">
                                    <div class="mx-auto">
                                        <div class="mx-auto d-blcok text-center mb-3">
                                            <img src="assets/img/noresult-chatboxicon.svg" alt="chatnotfound-icon">
                                        </div>
                                        <p class="mobile-pagetop-heading mb-2 text-center">No Messages Yet</p>
                                        <p class="mobile-pagetop-subheading d-block text-center max-350 mx-auto mb-4">Once you connect with a parent, your messages will be displayed here. </p>

                                    </div>
                                </div>
                            </div>
                        </ng-container>
                        <ng-template #jobsFound>

                            <div class="col-md-5 col-lg-4 pr-md-0">
                                <div class="chatbox--searcharea">
                                    <div class="position-relative w-100">
                                        <button class="search--btn" type="submit">
                                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                            <path d="M7.875 14.625C11.6029 14.625 14.625 11.6029 14.625 7.875C14.625 4.14708 11.6029 1.125 7.875 1.125C4.14708 1.125 1.125 4.14708 1.125 7.875C1.125 11.6029 4.14708 14.625 7.875 14.625Z" stroke="#3BB3BD" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                            <path d="M12.9375 12.9375L16.875 16.875" stroke="#3BB3BD" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                                            </svg>
                                        </button>
                                        <input type="search" class="navbar-serach-input w-100 pl-5" placeholder="Search Mentors">
                                    </div>
                                </div>
                                <div class="chatbox-inboxlist">
                                    <ul>
                                        <li *ngFor="let parent of parentDetails; let i= index;">
                                            <a href="javascript:void(0)" (click)="getMentorJobsById(id, parent?.job_id)">
                                                <div class="chat-fill-row">
                                                    <div class="chat-list">
                                                        <div class="chat-people">
                                                            <div class="chat-img">
                                                                <img [src]="parent?.parent_profile_image" alt="usericon">
                                                            </div>
                                                            <div class="chat-desc">
                                                                <p>{{parent?.parent_first_name}} {{parent?.parent_last_name}}</p>
                                                                <!--span>When I can reach to you and you can</span-->
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </a>
                                        </li>

                                    </ul>
                                </div>
                            </div>
                            <ng-container *ngFor="let job of getJobDetailsArray; let i= index;">
                                <div class="col-md-7 col-lg-8 border-md-chatarea pl-md-0">
                                    <ng-container *ngIf="job?.messages; else noMessagesFound;">
                                        <div class="chatbox-bodyheader">
                                            <div class="row align-items-center">
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <p class="chatbox-bodyheader-name d-block d-lg-inline-block mb-2 mb-lg-0">{{job?.parent?.first_name}} {{job?.parent?.last_name}}</p>
                                                            <!--p class="chatbox-bodyheader-status d-block d-lg-inline-block ml-lg-2">
                                                            <span class="active status--signal"></span> Active now
                                                        </p-->
                                                        </div>
                                                        <div class="col-12 mt-2">
                                                            <div class="max-320 font-0">
                                                                <span class="chatbox-bodyheader-designation vertical-align-middle d-inline-block">
                                                            {{job?.job_title}} ...
                                                        </span>
                                                                <span class="vertical-align-middle d-inline-block">
                                                            <a href="javascript:void(0)" routerLink="/mentor/booking-request/{{job?._id}}" class="anchor--primary font-14">View job post</a>
                                                        </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div *ngIf="job?.job_status == 'PENDING'" class="col-lg-4 mt-2 mt-lg-0 text-lg-right">
                                                    <button (click)="showUpdateBookingRequestPopup(job?._id, job?.parent_id, 'ACCEPTED')" role="button" type="button" class="primary--button mr-2 py-1 btn-fit">Accept</button>

                                                    <button (click)="showUpdateBookingRequestPopup(job?._id, job?.parent_id, 'CANCELLED')" role="button" type="button" class="alt--button py-1 btn-fit">Cancel</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="chatbox-bodycontent pb-0">
                                            <div class="chatbox-bodycontent-lock">
                                                <i class="fa fa-lock"></i> {{job?.mentor?.first_name}} {{job?.mentor?.last_name}} started the chat with {{job?.parent?.first_name}} {{job?.parent?.last_name}} on {{job?.created_at | date}}
                                            </div>
                                            <div class="chatbox-bodycontent-msgarea pb-0">

                                                <ul>
                                                    <li *ngFor="let message of job?.messages; let i= index;" [ngClass]="{'row-all-reverse': message?.sender_id === job?.mentor_id}" class="chatbox-bodycontent-msgarea-quote">
                                                        <div class="chatbox-bodycontent-msgarea-quote">
                                                            <span class="menu-profile-pic">
                                                                <img alt="profile-pic" [src]="message?.sender?.profileImagePath">
                                                            </span>
                                                            <div class="chatbox-bodycontent-msgarea-quote-subject">
                                                                <p>{{message?.message}}</p>
                                                                <div class="chatbox-bodycontent-msgarea-time">
                                                                    <p><span>{{message?.created_at | date:'medium'}}</span></p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                                <div *ngIf="job?.job_status == 'PENDING'" class="my-4">
                                                    <div class="chat--docsarea">
                                                        <div class="mx-auto max-650">
                                                            <p class="sent--quote text-center mb-2">
                                                                You recieve a Booking Request from {{job?.parent?.first_name}} {{job?.parent?.last_name}}
                                                                <a href="javascript:void(0)" class="anchor--primary" routerLink="/mentor/booking-request/{{job?._id}}">View Job Details</a>
                                                            </p>
                                                            <div class="row mt-3">
                                                                <div class="col-sm-4 col-md-6 col-lg-4 mb-responsive">
                                                                    <span class="sent--quote-subtitle text-center mb-1">Date</span>
                                                                    <p class="sent--quote text-center">
                                                                        {{(job?.booking_date)}}
                                                                    </p>
                                                                </div>
                                                                <div class="col-sm-4 col-md-6 col-lg-4 mb-responsive">
                                                                    <span class="sent--quote-subtitle text-center mb-1">time</span>
                                                                    <p class="sent--quote text-center">
                                                                        {{(job?.booking_time)}}
                                                                    </p>
                                                                </div>
                                                                <div class="col-sm-4 col-md-6 col-lg-4 mb-responsive">
                                                                    <span class="sent--quote-subtitle text-center mb-1">hourly rate</span>
                                                                    <p class="sent--quote text-center">
                                                                        ${{(job?.hourly_rate)}}/Hr
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="chatbox-bodycontent-msgarea-time text-right mt-2 px-4">
                                                        <p><span>{{job?.created_at | date:'medium'}}</span></p>
                                                    </div>
                                                </div>
                                                <form [formGroup]="messageForm">
                                                    <div class="chatbox-bodycontent-sentarea d-flex align-items-center">

                                                        <div class="chatbox-bodycontent-sentarea--upload">
                                                            <label for="uploadChatDocs" class="upload-doc--chatbtn">
                                                    <svg width="15" height="25" viewBox="0 0 15 25" fill="none">
                                                        <path d="M9.89941 0.859375C11.2255 0.859375 12.4973 1.38616 13.4349 2.32384C14.3726 3.26152 14.8994 4.53329 14.8994 5.85938V17.8594C14.8994 18.7786 14.7184 19.6889 14.3666 20.5382C14.0148 21.3874 13.4992 22.1591 12.8492 22.8091C12.1992 23.4591 11.4275 23.9747 10.5782 24.3265C9.72892 24.6783 8.81867 24.8594 7.89941 24.8594C6.98016 24.8594 6.06991 24.6783 5.22063 24.3265C4.37135 23.9747 3.59968 23.4591 2.94967 22.8091C2.29966 22.1591 1.78404 21.3874 1.43226 20.5382C1.08047 19.6889 0.899414 18.7786 0.899414 17.8594V9.85938H2.89941V17.8594C2.89941 19.1855 3.4262 20.4572 4.36388 21.3949C5.30156 22.3326 6.57333 22.8594 7.89941 22.8594C9.2255 22.8594 10.4973 22.3326 11.4349 21.3949C12.3726 20.4572 12.8994 19.1855 12.8994 17.8594V5.85938C12.8994 5.46541 12.8218 5.0753 12.6711 4.71132C12.5203 4.34735 12.2993 4.01663 12.0207 3.73805C11.7422 3.45948 11.4114 3.2385 11.0475 3.08774C10.6835 2.93697 10.2934 2.85937 9.89941 2.85937C9.50545 2.85937 9.11534 2.93697 8.75136 3.08774C8.38739 3.2385 8.05667 3.45948 7.77809 3.73805C7.49952 4.01663 7.27854 4.34735 7.12778 4.71132C6.97701 5.0753 6.89941 5.46541 6.89941 5.85938V17.8594C6.89941 18.1246 7.00477 18.3789 7.19231 18.5665C7.37984 18.754 7.6342 18.8594 7.89941 18.8594C8.16463 18.8594 8.41898 18.754 8.60652 18.5665C8.79406 18.3789 8.89941 18.1246 8.89941 17.8594V6.85938H10.8994V17.8594C10.8994 18.655 10.5833 19.4181 10.0207 19.9807C9.45813 20.5433 8.69506 20.8594 7.89941 20.8594C7.10376 20.8594 6.3407 20.5433 5.77809 19.9807C5.21548 19.4181 4.89941 18.655 4.89941 17.8594V5.85938C4.89941 4.53329 5.4262 3.26152 6.36388 2.32384C7.30156 1.38616 8.57333 0.859375 9.89941 0.859375V0.859375Z" fill="#3BB3BD"/>
                                                    </svg>                                                    
                                                        </label>
                                                            <input type="file" id="uploadChatDocs" class="hidden--filetype">
                                                        </div>
                                                        <div class="chatbox-bodycontent-sentarea--input" aria-labelledby="chatinputArea">
                                                            <input type="text" formControlName="message" r class="type--msgarea" placeholder="Type a message...">

                                                            <p class="errorCls" *ngIf="messageForm.controls.message.touched || isMessageFormSubmitted">
                                                                <app-form-validation-errors minLength=1 maxLength=5000 errorPrefix="Message " [errors]="messageForm.get('message').errors"></app-form-validation-errors>
                                                            </p>
                                                        </div>
                                                        <div class="chatbox-bodycontent-sentarea--formbtn">

                                                            <button [disabled]="messageForm.invalid" (click)="onSubmitMessageForm()" type="submit" class="w-100 btn--transparent">

                                                                <span class="mobile-sent--btn d-sm-none"><i class="fa fa-paper-plane" aria-hidden="true"></i></span>

                                                                <span class="primary--button px-4 d-none d-sm-inline-block w-100">Reply</span>
                                                            </button>
                                                        </div>

                                                    </div>
                                                </form>

                                            </div>
                                        </div>
                                    </ng-container>
                                    <ng-template #noMessagesFound>
                                        <div class="nochat-area">
                                            <div class="mx-auto">
                                                <div class="mx-auto d-blcok text-center mb-3">
                                                    <img src="assets/img/noresult-chatboxicon.svg" alt="chatnotfound-icon">
                                                </div>
                                                <p class="mobile-pagetop-heading mb-2 text-center">No Messages Yet</p>
                                                <p class="mobile-pagetop-subheading d-block text-center max-350 mx-auto mb-4">Once you connect with a parent, your messages will be displayed here. </p>

                                            </div>
                                        </div>
                                    </ng-template>
                                </div>
                            </ng-container>

                        </ng-template>
                    </div>
                </div>
            </div>
        </div>
    </div>

</section>


<app-update-booking-request (showUpdateBookingRequestPopup)="showUpdateBookingRequestPopup(getJobId, getParentId, getJobStatus)" (hideUpdateBookingRequestPopup)="hideUpdateBookingRequestPopup($event)" [getParentId]="getParentId" [getJobStatus]="getJobStatus"
    [getJobId]="getJobId" [isOpen]="isBookingMethodModalOpen"></app-update-booking-request>